# (PART\*) For Each Class {-}

# Class Setup

## Overview of Class Setup

This section will show you how to organize your class to make it easier to administer access to your content. You will need to have a list of who will be taking your class, such as a course roster or sign-up list, as well as a list of additional instructors or teaching assistants. You can make changes later, so the list of students need not be final.

## Identify Funding

### NHGRI STRIDES {#strides-funding}

Through the [STRIDES](https://datascience.nih.gov/strides) program, NHGRI makes funding available to new users of the AnVIL, in collaboration with the [NIH Office of Data Science Strategy](https://datascience.nih.gov/about/odss). NHGRI currently supports the [AnVIL Cloud Credits Program (AC2)](https://anvilproject.org/news/2021/04/12/announcing-anvil-cloud-cost-credits-program) and will have a second round of funding available in fall of 2021.

## Collect Google IDs

AnVIL IDs are based on [Google accounts](account-setup.html#google-account).

Students -- Contact students/participants to get their AnVIL IDs. These should be Gmail addresses or emails with GSuite capabilities. You can link students to [Student Account Setup](student-account-setup.html) for instructions on what they should do.

Co-instructors -- If you will be working with other instructors, such as co-instructors or teaching assistants, you will need to collect their IDs as well.

## Set Up Billing Projects

Billing Projects in Terra help organize your compute costs. We suggest creating two different billing projects under the appropriate Billing Account that you created on `cloud.google.com`: one for students and one for co-instructors.

Billing Projects must be globally unique and cannot exceed 30 characters.

### Instructor Billing Project

First, create the Billing Project for instructors. We suggest the name of the Billing Project should be a combination of institution-class-role (e.g., "jhu-bmr2021-instructors-bill-1"). To create a Billing Project for instructors:

1. Go to https://anvil.terra.bio/#billing

1. Click “+CREATE”

    ```{r, echo=FALSE, fig.alt='Screenshot of the Terra Billing page. The "+CREATE" button is highlighted.'}
leanbuild::include_slide("https://docs.google.com/presentation/d/1HHWg47Tg6miv_K7GNB6ZDTx-4Jc5IMl7APfFtD1Rqag/edit#slide=id.gdb96a00840_0_88")
    ```

1. Type in your instructor Billing Project name

    ```{r, echo=FALSE, fig.alt='Screenshot of the Terra Billing page with Create Billing Project pop out box. The new billing project name, jhu-bmr2021-instructors-bill-1, is highlighted.'}
leanbuild::include_slide("https://docs.google.com/presentation/d/1HHWg47Tg6miv_K7GNB6ZDTx-4Jc5IMl7APfFtD1Rqag/edit#slide=id.gdb96a00840_0_98")
    ```
    
1. Select the appropriate Billing Account

    ```{r, echo=FALSE, fig.alt='Screenshot of the Terra Billing page with Create Billing Project pop out box. The appropriate billing account name, My Billing Account, is highlighted.'}
leanbuild::include_slide("https://docs.google.com/presentation/d/1HHWg47Tg6miv_K7GNB6ZDTx-4Jc5IMl7APfFtD1Rqag/edit#slide=id.g100474897dd_0_2")
    ```
    
1. Click “CREATE BILLING PROJECT”

    ```{r, echo=FALSE, fig.alt='Screenshot of the Terra Billing page with Create Billing Project pop out box. The "CREATE BILLING PROJECT" button is highlighted.'}
leanbuild::include_slide("https://docs.google.com/presentation/d/1HHWg47Tg6miv_K7GNB6ZDTx-4Jc5IMl7APfFtD1Rqag/edit#slide=id.g100474897dd_0_9")
    ```
    
You now have a unique **Instructor Billing Project**.

### Student Billing Project

Next, create a student Billing Project. Again, we suggest a combination of institution-class-role (e.g., “jhu-bmr2021-students-bill-1”). To create a Billing Project for students:

1. Go to https://anvil.terra.bio/#billing 

1. Click “+CREATE”

    ```{r, echo=FALSE, fig.alt='Screenshot of the Terra Billing page. The "+CREATE" button is highlighted.'}
leanbuild::include_slide("https://docs.google.com/presentation/d/1HHWg47Tg6miv_K7GNB6ZDTx-4Jc5IMl7APfFtD1Rqag/edit#slide=id.gdb96a00840_0_88")
    ```
    
1. Type in your student Billing Project name

    ```{r, echo=FALSE, fig.alt='Screenshot of the Terra Billing page with Create Billing Project pop out box. The new billing project name, jhu-bmr2021-students-bill-1, is highlighted.'}
leanbuild::include_slide("https://docs.google.com/presentation/d/1HHWg47Tg6miv_K7GNB6ZDTx-4Jc5IMl7APfFtD1Rqag/edit#slide=id.g100474897dd_0_15")
    ```
    
1. Select the appropriate Billing Account (same as above)

    ```{r, echo=FALSE, fig.alt='Screenshot of the Terra Billing page with Create Billing Project pop out box. The appropriate billing account name, My Billing Account, is highlighted.'}
leanbuild::include_slide("https://docs.google.com/presentation/d/1HHWg47Tg6miv_K7GNB6ZDTx-4Jc5IMl7APfFtD1Rqag/edit#slide=id.g100474897dd_0_21")
    ```

1. Click “CREATE BILLING PROJECT”

    ```{r, echo=FALSE, fig.alt='Screenshot of the Terra Billing page with Create Billing Project pop out box. The "CREATE BILLING PROJECT" button is highlighted.'}
leanbuild::include_slide("https://docs.google.com/presentation/d/1HHWg47Tg6miv_K7GNB6ZDTx-4Jc5IMl7APfFtD1Rqag/edit#slide=id.g100474897dd_0_27")
    ```

You now have a unique **Student Billing Project**.
   
## Set Up Groups

Groups enable you to share your class Workspace and manage permissions for many people at once. Like Billing Projects, we recommend starting with one Group for instructors and one Group for students.

### Instructor Group

Create an informative, unique Group name for any co-instructors and teaching assistants, such as a combination of institution-class-role (e.g., “jhu-bmr2021-instructors”). Only letters, numbers, underscores, and dashes are allowed in Group names. To create a Group for instructors:

1. Go to https://anvil.terra.bio/#groups

1. Click “+ Create a New Group”

    ```{r, echo=FALSE, fig.alt='Screenshot of the Terra Group page. The "Create a New Group" button is highlighted.'}
leanbuild::include_slide("https://docs.google.com/presentation/d/1HHWg47Tg6miv_K7GNB6ZDTx-4Jc5IMl7APfFtD1Rqag/edit#slide=id.gdb96a00840_0_6")
    ```

1. Type in your instructor Group name

1. Click “CREATE GROUP”

    ```{r, echo=FALSE, fig.alt='Screenshot of the Terra Group page with Create New Group pop out box. The Group name, jhu-bmr2021-instructors, has been entered and the "CREATE GROUP" button is highlighted.'}
leanbuild::include_slide("https://docs.google.com/presentation/d/1HHWg47Tg6miv_K7GNB6ZDTx-4Jc5IMl7APfFtD1Rqag/edit#slide=id.gdb96a00840_0_16")
    ```

You now have a unique **Instructor Group**.

### Student Group

Next, create an informative, unique Group name for students, such as a combination of institution-class-role (e.g., “jhu-bmr2021-students”). Only letters, numbers, underscores, and dashes are allowed in Group names. To create a Group for students:

1. Go to https://anvil.terra.bio/#groups

1. Click “+ Create a New Group”

    ```{r, echo=FALSE, fig.alt='Screenshot of the Terra Group page. The "Create a New Group" button is highlighted.'}
leanbuild::include_slide("https://docs.google.com/presentation/d/1HHWg47Tg6miv_K7GNB6ZDTx-4Jc5IMl7APfFtD1Rqag/edit#slide=id.gdb96a00840_0_6")
    ```

1. Type in your student Group name

1. Click “CREATE GROUP”

    ```{r, echo=FALSE, fig.alt='Screenshot of the Terra Group page with Create New Group pop out box. The Group name, jhu-bmr2021-students, has been entered and the "CREATE GROUP" button is highlighted.'}
leanbuild::include_slide("https://docs.google.com/presentation/d/1HHWg47Tg6miv_K7GNB6ZDTx-4Jc5IMl7APfFtD1Rqag/edit#slide=id.g100474897dd_0_38")
    ```

You now have a unique **Student Group**.

### Group Email List

Note that your newly created groups have group emails associated with them.

```{r, echo=FALSE, fig.alt='Screenshot of the Terra Group page. Emails associated with newly formed groups have been highlighted.'}
leanbuild::include_slide("https://docs.google.com/presentation/d/1HHWg47Tg6miv_K7GNB6ZDTx-4Jc5IMl7APfFtD1Rqag/edit#slide=id.g100474897dd_0_96")
```

### Add Instructors as "Owner"

Now that your Groups have been created, you will want to add additional instructors to your **Instructor Group**. First click on the name of the **Instructor Group** you just made. This should take you to the administration page for the Group. The page should be visible at `https://anvil.terra.bio/#groups/<group-name>` (e.g., `https://anvil.terra.bio/#groups/jhu-bmr2021-instructors`). With the steps below, you will add an additional instructor to appear alongside your AnVIL ID. You will also ensure that they have the correct permissions. 

1. Go to https://anvil.terra.bio/#groups/<group-name>

1. Click on “+Add User”. You will be prompted to add the instructor’s AnVIL ID. 

    ```{r, echo=FALSE, fig.alt='Screenshot of the Terra Group page for the specific group that was just created. The "+Add User" button is highlighted.'}
leanbuild::include_slide("https://docs.google.com/presentation/d/1HHWg47Tg6miv_K7GNB6ZDTx-4Jc5IMl7APfFtD1Rqag/edit#slide=id.g100474897dd_0_45")
    ```

1. Type in the instructor’s AnVIL ID

    ```{r, echo=FALSE, fig.alt='Screenshot of the Terra Group for the specific group that was just created, with "Add user to Terra Group" pop out box. The instructor`s AnVIL ID, instructor-1@gmail.com, has been entered and the AnVIL ID (email) is highlighted.'}
leanbuild::include_slide("https://docs.google.com/presentation/d/1HHWg47Tg6miv_K7GNB6ZDTx-4Jc5IMl7APfFtD1Rqag/edit#slide=id.g100474897dd_0_58")
    ```

1. Make sure “Can manage users (admin)” is **selected**

    ```{r, echo=FALSE, fig.alt='Screenshot of the Terra Group for the specific group that was just created, with "Add user to Terra Group" pop out box. The instructor`s AnVIL ID, instructor-1@gmail.com, has been entered and the checkbox "Can manage users (admin)" has been selected and is highlighted.'}
leanbuild::include_slide("https://docs.google.com/presentation/d/1HHWg47Tg6miv_K7GNB6ZDTx-4Jc5IMl7APfFtD1Rqag/edit#slide=id.g100474897dd_0_65")
    ```

1. Click ADD USER. This will take you back to the Group administration page.

    ```{r, echo=FALSE, fig.alt='Screenshot of the Terra Group for the specific group that was just created, with "Add user to Terra Group" pop out box. The instructor`s AnVIL ID, instructor-1@gmail.com, has been entered and the "ADD USER" button is highlighted.'}
leanbuild::include_slide("https://docs.google.com/presentation/d/1HHWg47Tg6miv_K7GNB6ZDTx-4Jc5IMl7APfFtD1Rqag/edit#slide=id.g100474897dd_0_71")
    ```

Check to ensure the newly added instructor displays “Admin” under “Roles” beside their AnVIL ID. Repeat this process for any additional co-instructors and teaching assistants.

```{r, echo=FALSE, fig.alt='Screenshot of the Terra Group for the instructor group that was just created, where the newly added instructor is visible in the user list. The instructor`s AnVIL ID, instructor-1@gmail.com is visible next to the role "Admin", which is highlighted.'}
leanbuild::include_slide("https://docs.google.com/presentation/d/1HHWg47Tg6miv_K7GNB6ZDTx-4Jc5IMl7APfFtD1Rqag/edit#slide=id.g100474897dd_0_78")
```

### Add Students as "Member"

To add participants to your **Student Group**, first click on the name of the **Student Group** you just made. This should take you to the administration page for the Group. The page should be visible at `https://anvil.terra.bio/#groups/<group-name>` (e.g., `https://anvil.terra.bio/#groups/jhu-bmr2021-students`). With the steps below, you will add students to the list of **Student Group** members.

1. Go to https://anvil.terra.bio/#groups/<group-name>

1. Click on “+Add User”. You will be prompted to add an AnVIL ID. 

    ```{r, echo=FALSE, fig.alt='Screenshot of the Terra Group page for the specific group that was just created. The "+Add User" button is highlighted.'}
leanbuild::include_slide("https://docs.google.com/presentation/d/1HHWg47Tg6miv_K7GNB6ZDTx-4Jc5IMl7APfFtD1Rqag/edit#slide=id.g100474897dd_0_104")
    ```

1. Type in the student’s AnVIL ID

    ```{r, echo=FALSE, fig.alt='Screenshot of the Terra Group for the specific group that was just created, with "Add user to Terra Group" pop out box. The student`s AnVIL ID, student-1@gmail.com, has been entered and the AnVIL ID (email) is highlighted.'}
leanbuild::include_slide("https://docs.google.com/presentation/d/1HHWg47Tg6miv_K7GNB6ZDTx-4Jc5IMl7APfFtD1Rqag/edit#slide=id.g100474897dd_0_111")
    ```

1. Click ADD USER

    ```{r, echo=FALSE, fig.alt='Screenshot of the Terra Group for the specific group that was just created, with "Add user to Terra Group" pop out box. The student`s AnVIL ID, student-1@gmail.com, has been entered and the "ADD USER" button is highlighted.'}
leanbuild::include_slide("https://docs.google.com/presentation/d/1HHWg47Tg6miv_K7GNB6ZDTx-4Jc5IMl7APfFtD1Rqag/edit#slide=id.g100474897dd_0_117")
    ```

Check to ensure the newly added student displays “Member” under “Roles” beside their AnVIL ID. At present, each student’s AnVIL ID must be added separately.

```{r, echo=FALSE, fig.alt='Screenshot of the Terra Group for the student group that was just created, where the newly added student is visible in the user list. The student`s AnVIL ID, student-1@gmail.com is visible next to the role "Member", which is highlighted.'}
leanbuild::include_slide("https://docs.google.com/presentation/d/1HHWg47Tg6miv_K7GNB6ZDTx-4Jc5IMl7APfFtD1Rqag/edit#slide=id.g100474897dd_0_125")
```

You also want to ensure any additional co-instructors and teaching assistants are able to administer the **Student Group** in case you are unavailable. Repeat the following for each co-instructor in the **Student Group**:

1. Click on “+Add User”. You will be prompted to add the instructor’s AnVIL ID. 

1. Type in the instructor’s AnVIL ID

1. Make sure “Can manage users (admin)” is selected

1. Click ADD USER. This will take you back to the Group administration page.

```{r, echo=FALSE, fig.alt='Screenshot of the Terra Group for the student group that was just created, where the newly added instructor is visible in the user list. The instructor`s AnVIL ID, instructor-1@gmail.com is visible next to the role "Admin", which is highlighted.'}
leanbuild::include_slide("https://docs.google.com/presentation/d/1HHWg47Tg6miv_K7GNB6ZDTx-4Jc5IMl7APfFtD1Rqag/edit#slide=id.g100474897dd_0_87")
```

Your instructor and student groups are now set up.

## Set Permissions - Billing Projects

Now that your Groups have been created, it is relatively easy to permit other instructors and students to compute using your instructor and student Terra Billing Projects. You can change permissions for Billing Projects on https://anvil.terra.bio/#billing. AnVIL users can either be “Owners” Or “Users” of Billing Projects

### Add Instructors as “Owner”

To set instructor permissions:

1. Go to https://anvil.terra.bio/#billing

1. Select the “Owned by You” Billing Project sub-list

1. Select the Billing Project you made for instructors in [### Set Up Billing Projects]

1. Select the “Users” tab

1. Click “+ Add User”. You will be prompted to add a “User email *”.

1. Begin typing the instructor group name set up in [### Set Up Groups]. You should see an email in the form <group-name>@firecloud.org (e.g., jhu-bmr2021-instructors@firecloud.org).

1. Ensure “Can manage users (Owner)” is **selected**

1. Click “ADD USER”

### Add Students as “User”

To set student permissions:

1. Go to https://anvil.terra.bio/#billing

1. Select the “Owned by You” Billing Project sub-list

1. Select the Billing Project you made for students in [### Set Up Billing Projects]

1. Select the “Users” tab

1. Click “+ Add User”. You will be prompted to add a “User email *”.

1. Begin typing the student group name set up in [### Set Up Groups]. You should see an email in the form <group-name>@firecloud.org (e.g., jhu-bmr2021-students@firecloud.org). 

1. Keep “Can manage users (Owner)” deselected.

1. Click “ADD USER”

You also want to ensure any additional co-instructors and teaching assistants are able to administer the student Billing Project in case you are unavailable. Add the instructor Group to the student Billing Project:

1. Click “+ Add User”. You will be prompted to add a “User email *”.

1. Begin typing the instructor group name set up in [### Set Up Groups]. You should see an email in the form <group-name>@firecloud.org (e.g., jhu-bmr2021-instructors@firecloud.org).

1. Ensure “Can manage users (Owner)” is **selected**

1. Click “ADD USER”

## Set Permissions - Workspace

### Add Instructors as “Owner”

### Add Students as “User”

## Notify Terra

Contacting Terra ahead of your class time helps the Terra team avoid any major disruptions to your class. Contact Terra by [submitting a request](https://support.terra.bio/hc/en-us/requests/new) for a hold on scheduled maintenance and downtime. It’s also a good idea to ask about major changes planned for the time prior to your class.
